"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[217],{935(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"packages/zod-to-proto","title":"@globalart/zod-to-proto","description":"A library for converting Zod schemas to Protobuf definitions. Automatically generates .proto files from Zod validation schemas, including support for gRPC services.","source":"@site/content/packages/zod-to-proto.mdx","sourceDirName":"packages","slug":"/packages/zod-to-proto","permalink":"/packages/zod-to-proto","draft":false,"unlisted":false,"editUrl":"https://github.com/GlobalArtInc/ecosystem/tree/main/docs/content/packages/zod-to-proto.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"@globalart/nestjs-typeorm-outbox","permalink":"/packages/nestjs-typeorm-outbox"},"next":{"title":"@globalart/passport","permalink":"/packages/passport"}}');var i=s(6259),t=s(3230);const o={sidebar_position:7},c="@globalart/zod-to-proto",a={},d=[{value:"Installation",id:"installation",level:2},{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Generating gRPC Services",id:"generating-grpc-services",level:3},{value:"Option 1: Using Zod Schemas with Functions (Recommended)",id:"option-1-using-zod-schemas-with-functions-recommended",level:4},{value:"Option 2: Using Service Definitions Array",id:"option-2-using-service-definitions-array",level:4},{value:"Configuration",id:"configuration",level:2},{value:"ZodToProtobufOptions",id:"zodtoprotobufoptions",level:3},{value:"Service Definition",id:"service-definition",level:3},{value:"Usage",id:"usage",level:2},{value:"With Custom Type Prefix",id:"with-custom-type-prefix",level:3},{value:"With Streaming Methods",id:"with-streaming-methods",level:3},{value:"Without Warning Declaration",id:"without-warning-declaration",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"zodToProtobufService",id:"zodtoprotobufservice",level:3},{value:"Supported Zod Types",id:"supported-zod-types",level:2},{value:"Basic Types",id:"basic-types",level:3},{value:"Collections",id:"collections",level:3},{value:"Complex Types",id:"complex-types",level:3},{value:"Examples",id:"examples",level:3},{value:"Advanced Usage",id:"advanced-usage",level:2},{value:"Working with Maps and Records",id:"working-with-maps-and-records",level:3},{value:"Type-Safe Service Definitions",id:"type-safe-service-definitions",level:3},{value:"Avoiding Circular Dependencies",id:"avoiding-circular-dependencies",level:3},{value:"Multiple Services",id:"multiple-services",level:3},{value:"Nested Objects and Enums",id:"nested-objects-and-enums",level:3},{value:"Limitations",id:"limitations",level:2},{value:"Best Practices",id:"best-practices",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"globalartzod-to-proto",children:"@globalart/zod-to-proto"})}),"\n",(0,i.jsxs)(n.p,{children:["A library for converting Zod schemas to Protobuf definitions. Automatically generates ",(0,i.jsx)(n.code,{children:".proto"})," files from Zod validation schemas, including support for gRPC services."]}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:"npm2yarn",children:"npm install @globalart/zod-to-proto zod\n"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"@globalart/zod-to-proto"})," package provides a convenient way to generate Protobuf definitions from Zod schemas, enabling:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type-safe schemas"})," - Use Zod for validation and automatically generate Protobuf definitions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"gRPC support"})," - Generate complete gRPC service definitions from Zod schemas"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multiple services"})," - Define multiple services in a single protobuf file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"TypeScript integration"})," - Full TypeScript support with proper types"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Schema conversion"})," - Convert Zod schemas to Protobuf messages"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"gRPC services"})," - Generate gRPC service definitions from Zod function schemas"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multiple formats"})," - Support for arrays, maps, records, enums, and nested objects"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Type safety"})," - Full TypeScript support"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Flexible configuration"})," - Customize package names, message names, and type prefixes"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,i.jsx)(n.h3,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { zodToProtobufService } from "@globalart/zod-to-proto";\nimport { z } from "zod";\n\nconst userSchema = z.object({\n  name: z.string(),\n  age: z.number(),\n  email: z.string().email(),\n});\n\nconst protoDefinition = zodToProtobufService({\n  packageName: "user.service",\n  services: {\n    UserService: z.object({\n      getUser: z.function({\n        input: [z.object({ id: z.number().int() })],\n        output: userSchema,\n      }),\n    }),\n  },\n});\n\nconsole.log(protoDefinition);\n'})}),"\n",(0,i.jsx)(n.p,{children:"Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-protobuf",children:'syntax = "proto3";\npackage user.service;\n\nmessage GetUserRequest {\n  int32 id = 1;\n}\n\nmessage GetUserResponse {\n  string name = 1;\n  int32 age = 2;\n  string email = 3;\n}\n\nservice UserService {\n  rpc GetUser(GetUserRequest) returns (GetUserResponse);\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"generating-grpc-services",children:"Generating gRPC Services"}),"\n",(0,i.jsx)(n.p,{children:"There are two ways to define gRPC services:"}),"\n",(0,i.jsx)(n.h4,{id:"option-1-using-zod-schemas-with-functions-recommended",children:"Option 1: Using Zod Schemas with Functions (Recommended)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { zodToProtobufService } from "@globalart/zod-to-proto";\nimport { z } from "zod";\n\nconst getUserByIdRequestSchema = z.object({\n  id: z.number().int(),\n});\n\nconst userSchema = z.object({\n  id: z.number().int(),\n  name: z.string(),\n  email: z.string(),\n});\n\nconst userServiceSchema = z.object({\n  getUserById: z.function({\n    input: [getUserByIdRequestSchema],\n    output: userSchema,\n  }),\n  createUser: z.function({\n    input: [userSchema],\n    output: z.object({\n      id: z.number().int(),\n      success: z.boolean(),\n    }),\n  }),\n});\n\nconst protoDefinition = zodToProtobufService({\n  packageName: "user.service",\n  services: {\n    UserService: userServiceSchema,\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h4,{id:"option-2-using-service-definitions-array",children:"Option 2: Using Service Definitions Array"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { zodToProtobufService } from "@globalart/zod-to-proto";\nimport { z } from "zod";\n\nconst protoDefinition = zodToProtobufService({\n  packageName: "user.service",\n  services: [\n    {\n      name: "UserService",\n      methods: [\n        {\n          name: "getUser",\n          request: z.object({\n            id: z.string(),\n          }),\n          response: z.object({\n            name: z.string(),\n            age: z.number(),\n            email: z.string(),\n          }),\n        },\n        {\n          name: "createUser",\n          request: z.object({\n            name: z.string(),\n            age: z.number(),\n            email: z.string(),\n          }),\n          response: z.object({\n            id: z.string(),\n            success: z.boolean(),\n          }),\n        },\n      ],\n    },\n  ],\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"Both approaches produce the same output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-protobuf",children:'syntax = "proto3";\npackage user.service;\n\nmessage GetUserByIdRequest {\n  int32 id = 1;\n}\n\nmessage GetUserByIdResponse {\n  int32 id = 1;\n  string name = 2;\n  string email = 3;\n}\n\nmessage CreateUserRequest {\n  int32 id = 1;\n  string name = 2;\n  string email = 3;\n}\n\nmessage CreateUserResponse {\n  int32 id = 1;\n  bool success = 2;\n}\n\nservice UserService {\n  rpc GetUserById(GetUserByIdRequest) returns (GetUserByIdResponse);\n  rpc CreateUser(CreateUserRequest) returns (CreateUserResponse);\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"zodtoprotobufoptions",children:"ZodToProtobufOptions"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Option"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"packageName"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:'Protobuf package name (default: "default")'})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"typePrefix"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"string"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"Prefix for type names"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"services"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ServicesInput"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"gRPC service definitions"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"warningDeclaration"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"boolean"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"Add warning comment at the beginning of the file (default: true)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"skipRootMessage"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"boolean"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"Skip root message generation"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"service-definition",children:"Service Definition"}),"\n",(0,i.jsx)(n.p,{children:"You can define services in two ways:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option 1: Using Zod Schemas (Recommended)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const serviceSchema = z.object({\n  methodName: z.function({\n    input: [requestSchema],\n    output: responseSchema,\n  }),\n});\n\nconst proto = zodToProtobufService({\n  services: {\n    ServiceName: serviceSchema,\n  },\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Option 2: Using Service Definitions Array"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface ServiceDefinition {\n  name: string;\n  methods: ServiceMethod[];\n}\n\ninterface ServiceMethod {\n  name: string;\n  request: ZodTypeAny;\n  response: ZodTypeAny;\n  streaming?: "client" | "server" | "bidirectional";\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.h3,{id:"with-custom-type-prefix",children:"With Custom Type Prefix"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const protoDefinition = zodToProtobufService({\n  packageName: "api.v1",\n  typePrefix: "ApiV1",\n  services: {\n    UserService: userServiceSchema,\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"with-streaming-methods",children:"With Streaming Methods"}),"\n",(0,i.jsx)(n.p,{children:"Streaming methods are defined through metadata in the Zod schema:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const chatServiceSchema = z.object({\n  sendMessage: z.function({\n    input: [z.object({ message: z.string() })],\n    output: z.object({ success: z.boolean() }),\n  }),\n  streamMessages: z\n    .function({\n      input: [z.object({ roomId: z.string() })],\n      output: z.object({ message: z.string() }),\n    })\n    .meta({ streaming: "server" }),\n  chat: z\n    .function({\n      input: [z.object({ message: z.string() })],\n      output: z.object({ message: z.string() }),\n    })\n    .meta({ streaming: "bidirectional" }),\n});\n\nconst protoDefinition = zodToProtobufService({\n  packageName: "chat.service",\n  services: {\n    ChatService: chatServiceSchema,\n  },\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"Or through service definitions array:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const protoDefinition = zodToProtobufService({\n  packageName: "chat.service",\n  services: [\n    {\n      name: "ChatService",\n      methods: [\n        {\n          name: "sendMessage",\n          request: z.object({ message: z.string() }),\n          response: z.object({ success: z.boolean() }),\n        },\n        {\n          name: "streamMessages",\n          request: z.object({ roomId: z.string() }),\n          response: z.object({ message: z.string() }),\n          streaming: "server",\n        },\n        {\n          name: "chat",\n          request: z.object({ message: z.string() }),\n          response: z.object({ message: z.string() }),\n          streaming: "bidirectional",\n        },\n      ],\n    },\n  ],\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-protobuf",children:"service ChatService {\n  rpc SendMessage(SendMessageRequest) returns (SendMessageResponse);\n  rpc StreamMessages(StreamMessagesRequest) returns (stream StreamMessagesResponse);\n  rpc Chat(stream ChatRequest) returns (stream ChatResponse);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"without-warning-declaration",children:"Without Warning Declaration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const protoDefinition = zodToProtobufService({\n  packageName: "example",\n  warningDeclaration: false,\n  services: {\n    ExampleService: exampleServiceSchema,\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,i.jsx)(n.h3,{id:"zodtoprotobufservice",children:"zodToProtobufService"}),"\n",(0,i.jsx)(n.p,{children:"Converts Zod schemas to a Protobuf definition."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"options"})," (optional): ",(0,i.jsx)(n.code,{children:"ZodToProtobufOptions"})," - Configuration options"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Returns:"})," ",(0,i.jsx)(n.code,{children:"string"})," - Protobuf definition as a string"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const protoDefinition = zodToProtobufService({\n  packageName: "user.service",\n  services: {\n    UserService: userServiceSchema,\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"supported-zod-types",children:"Supported Zod Types"}),"\n",(0,i.jsx)(n.h3,{id:"basic-types",children:"Basic Types"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.string()"})," \u2192 ",(0,i.jsx)(n.code,{children:"string"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.number()"})," \u2192 ",(0,i.jsx)(n.code,{children:"int32"})," (or ",(0,i.jsx)(n.code,{children:"double"})," for numbers with ",(0,i.jsx)(n.code,{children:"float32"}),"/",(0,i.jsx)(n.code,{children:"float64"})," format)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.boolean()"})," \u2192 ",(0,i.jsx)(n.code,{children:"bool"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.bigint()"})," \u2192 ",(0,i.jsx)(n.code,{children:"int64"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.date()"})," \u2192 ",(0,i.jsx)(n.code,{children:"string"})]}),"\n",(0,i.jsxs)(n.li,{children:["Custom types for ",(0,i.jsx)(n.code,{children:"bytes"})," (via Buffer/Uint8Array check)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"collections",children:"Collections"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.array()"})," \u2192 ",(0,i.jsx)(n.code,{children:"repeated"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.set()"})," \u2192 ",(0,i.jsx)(n.code,{children:"repeated"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.map()"})," \u2192 ",(0,i.jsx)(n.code,{children:"map<keyType, valueType>"})," (key must be int32, int64, string, or bool)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.record()"})," \u2192 ",(0,i.jsx)(n.code,{children:"map<keyType, valueType>"})," (same as z.map())"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.tuple()"})," \u2192 nested message"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"complex-types",children:"Complex Types"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.object()"})," \u2192 nested message"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.enum()"})," \u2192 ",(0,i.jsx)(n.code,{children:"enum"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.optional()"})," \u2192 ",(0,i.jsx)(n.code,{children:"optional"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"z.nullable()"})," \u2192 ",(0,i.jsx)(n.code,{children:"optional"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'import { zodToProtobufService } from "@globalart/zod-to-proto";\nimport { z } from "zod";\n\nconst schema = z.object({\n  id: z.string(),\n  tags: z.array(z.string()),\n  metadata: z.map(z.string(), z.number()),\n  settings: z.record(z.string(), z.string()),\n  status: z.enum(["active", "inactive", "pending"]),\n  profile: z.object({\n    firstName: z.string(),\n    lastName: z.string(),\n    age: z.number().optional(),\n  }),\n  coordinates: z.tuple([z.number(), z.number()]),\n});\n\nconst protoDefinition = zodToProtobufService({\n  packageName: "example",\n  services: {\n    ExampleService: z.object({\n      getData: z.function({\n        input: [z.object({ id: z.string() })],\n        output: schema,\n      }),\n    }),\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"advanced-usage",children:"Advanced Usage"}),"\n",(0,i.jsx)(n.h3,{id:"working-with-maps-and-records",children:"Working with Maps and Records"}),"\n",(0,i.jsxs)(n.p,{children:["Protobuf maps have strict key type requirements. Only integral types, strings, and booleans are allowed as keys. Both ",(0,i.jsx)(n.code,{children:"z.map()"})," and ",(0,i.jsx)(n.code,{children:"z.record()"})," are converted to protobuf ",(0,i.jsx)(n.code,{children:"map<>"})," type:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"const schema = z.object({\n  usersByStringId: z.map(z.string(), userSchema),\n  usersByIntId: z.map(z.number().int(), userSchema),\n  flagsMap: z.map(z.boolean(), z.string()),\n  metadataRecord: z.record(z.string(), z.string()),\n  settingsRecord: z.record(z.string(), z.number()),\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"type-safe-service-definitions",children:"Type-Safe Service Definitions"}),"\n",(0,i.jsx)(n.p,{children:"When using Zod schemas for services, you get full TypeScript type safety:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const userServiceSchema = z.object({\n  getUser: z.function({\n    input: [z.object({ id: z.number().int() })],\n    output: userSchema,\n  }),\n});\n\ntype UserService = z.infer<typeof userServiceSchema>;\n\nclass UserServiceImpl implements UserService {\n  async getUser({ id }: { id: number }) {\n    return { id, name: "John", email: "john@example.com" };\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"avoiding-circular-dependencies",children:"Avoiding Circular Dependencies"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Important:"})," Avoid circular dependencies between schema files. Circular imports will cause types to become ",(0,i.jsx)(n.code,{children:"undefined"})," during schema construction."]}),"\n",(0,i.jsxs)(n.p,{children:["\u274c ",(0,i.jsx)(n.strong,{children:"Bad Example:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// user.schema.ts\nimport { getUserByIdResponseSchema } from "./get-user-by-id.schema";\n\nexport const userSchema = z.object({ ... });\n\nexport const userServiceSchema = z.object({\n  getUserById: z.function({\n    input: [...],\n    output: getUserByIdResponseSchema,\n  }),\n});\n\n// get-user-by-id.schema.ts\nimport { userSchema } from "./user.schema";\n\nexport const getUserByIdResponseSchema = userSchema;\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u2705 ",(0,i.jsx)(n.strong,{children:"Good Example:"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// user.schema.ts\nimport { getUserByIdRequestSchema } from "./get-user-by-id.schema";\n\nexport const userSchema = z.object({ ... });\n\nexport const userServiceSchema = z.object({\n  getUserById: z.function({\n    input: [getUserByIdRequestSchema],\n    output: userSchema,\n  }),\n});\n\n// get-user-by-id.schema.ts\nexport const getUserByIdRequestSchema = z.object({ id: z.number().int() });\n'})}),"\n",(0,i.jsx)(n.h3,{id:"multiple-services",children:"Multiple Services"}),"\n",(0,i.jsx)(n.p,{children:"You can define multiple services in a single protobuf file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const protoDefinition = zodToProtobufService({\n  packageName: "api.v1",\n  services: {\n    UserService: userServiceSchema,\n    AuthService: authServiceSchema,\n    ProductService: productServiceSchema,\n  },\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"nested-objects-and-enums",children:"Nested Objects and Enums"}),"\n",(0,i.jsx)(n.p,{children:"Nested objects are automatically converted to separate messages with names based on the parent context:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const schema = z.object({\n  user: z.object({\n    profile: z.object({\n      name: z.string(),\n      status: z.enum(["active", "inactive"]),\n    }),\n  }),\n});\n\nconst protoDefinition = zodToProtobufService({\n  packageName: "example",\n  services: {\n    ExampleService: z.object({\n      getData: z.function({\n        input: [z.object({})],\n        output: schema,\n      }),\n    }),\n  },\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:"Output:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-protobuf",children:"message User {\n  UserProfile profile = 1;\n}\n\nmessage UserProfile {\n  string name = 1;\n  UserProfileStatus status = 2;\n}\n\nenum UserProfileStatus {\n  active = 0;\n  inactive = 1;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Only the types listed above are supported"}),"\n",(0,i.jsx)(n.li,{children:"Unsupported types will throw an exception"}),"\n",(0,i.jsx)(n.li,{children:"Nested objects are automatically converted to separate messages"}),"\n",(0,i.jsx)(n.li,{children:"Enum values are converted to numbers starting from 0"}),"\n",(0,i.jsxs)(n.li,{children:["Map keys must be integral types (int32, int64, etc.), strings, or booleans - ",(0,i.jsx)(n.strong,{children:"not"})," doubles or floats"]}),"\n",(0,i.jsx)(n.li,{children:"Avoid circular dependencies between schema files"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use Zod schemas for services"})," - Provides better type safety and maintainability"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Avoid circular dependencies"})," - Structure schemas to prevent circular imports"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use type prefixes"})," - Helps organize types in large projects"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validate map keys"})," - Ensure map keys are valid Protobuf key types"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Organize schemas"})," - Keep related schemas together and avoid circular references"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use metadata for streaming"})," - Define streaming methods via ",(0,i.jsx)(n.code,{children:'.meta({ streaming: "..." })'})," for type safety"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},3230(e,n,s){s.d(n,{R:()=>o,x:()=>c});var r=s(1299);const i={},t=r.createContext(i);function o(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);