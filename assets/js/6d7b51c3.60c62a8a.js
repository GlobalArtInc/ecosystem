"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[258],{2500(e,n,r){r.d(n,{R:()=>s,x:()=>l});var i=r(1299);const o={},t=i.createContext(o);function s(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(t.Provider,{value:n},e.children)}},5312(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"packages/nestjs-temporal","title":"@globalart/nestjs-temporal","description":"A NestJS module for working with Temporal workflows and activities. Provides a convenient API for creating Temporal workers, registering activities, and using Temporal clients to start workflows.","source":"@site/content/packages/nestjs-temporal.mdx","sourceDirName":"packages","slug":"/packages/nestjs-temporal","permalink":"/packages/nestjs-temporal","draft":false,"unlisted":false,"editUrl":"https://github.com/GlobalArtInc/ecosystem/tree/main/docs/content/packages/nestjs-temporal.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"@globalart/nestjs-grpc","permalink":"/packages/nestjs-grpc"},"next":{"title":"@globalart/nestjs-typeorm-outbox","permalink":"/packages/nestjs-typeorm-outbox"}}');var o=r(6259),t=r(2500);const s={sidebar_position:7},l="@globalart/nestjs-temporal",c={},a=[{value:"Installation",id:"installation",level:2},{value:"Overview",id:"overview",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"Module Setup",id:"module-setup",level:3},{value:"Registering Activities",id:"registering-activities",level:3},{value:"Using the Client",id:"using-the-client",level:3},{value:"Registering Workflows",id:"registering-workflows",level:3},{value:"Configuration",id:"configuration",level:2},{value:"TemporalModule.registerWorker",id:"temporalmoduleregisterworker",level:3},{value:"TemporalModule.registerClient",id:"temporalmoduleregisterclient",level:3},{value:"Usage",id:"usage",level:2},{value:"Creating Activities",id:"creating-activities",level:3},{value:"Creating Workflows",id:"creating-workflows",level:3},{value:"Using Multiple Workers",id:"using-multiple-workers",level:3},{value:"Async Configuration",id:"async-configuration",level:3},{value:"Using Named Clients",id:"using-named-clients",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"TemporalModule",id:"temporalmodule",level:3},{value:"<code>registerWorker(options: WorkerOptions): DynamicModule</code>",id:"registerworkeroptions-workeroptions-dynamicmodule",level:4},{value:"<code>registerWorkerAsync(options: SharedWorkerAsyncConfiguration): DynamicModule</code>",id:"registerworkerasyncoptions-sharedworkerasyncconfiguration-dynamicmodule",level:4},{value:"<code>registerClient(options?: TemporalModuleOptions): DynamicModule</code>",id:"registerclientoptions-temporalmoduleoptions-dynamicmodule",level:4},{value:"<code>registerClientAsync(options: SharedWorkflowClientOptions): DynamicModule</code>",id:"registerclientasyncoptions-sharedworkflowclientoptions-dynamicmodule",level:4},{value:"Activities Decorator",id:"activities-decorator",level:3},{value:"<code>@Activities(queueNameOrOptions?: string | ActivitiesOptions): ClassDecorator</code>",id:"activitiesqueuenameoroptions-string--activitiesoptions-classdecorator",level:4},{value:"Activity Decorator",id:"activity-decorator",level:3},{value:"<code>@Activity(nameOrOptions?: string | ActivityOptions): MethodDecorator</code>",id:"activitynameoroptions-string--activityoptions-methoddecorator",level:4},{value:"Workflows Decorator",id:"workflows-decorator",level:3},{value:"<code>@Workflows(nameOrOptions?: string | WorkflowsOptions): ClassDecorator</code>",id:"workflowsnameoroptions-string--workflowsoptions-classdecorator",level:4},{value:"WorkflowMethod Decorator",id:"workflowmethod-decorator",level:3},{value:"<code>@WorkflowMethod(nameOrOptions?: string | WorkflowMethodOptions): MethodDecorator</code>",id:"workflowmethodnameoroptions-string--workflowmethodoptions-methoddecorator",level:4},{value:"InjectTemporalClient",id:"injecttemporalclient",level:3},{value:"<code>InjectTemporalClient(name?: string): ParameterDecorator</code>",id:"injecttemporalclientname-string-parameterdecorator",level:4},{value:"Features",id:"features",level:2},{value:"Automatic Activity Discovery",id:"automatic-activity-discovery",level:3},{value:"Global Module",id:"global-module",level:3},{value:"Application Shutdown",id:"application-shutdown",level:3},{value:"Usage Examples",id:"usage-examples",level:2},{value:"Complete Example",id:"complete-example",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Using with ConfigService",id:"using-with-configservice",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Worker Not Starting",id:"worker-not-starting",level:3},{value:"Activities Not Found",id:"activities-not-found",level:3},{value:"Client Not Found",id:"client-not-found",level:3},{value:"Connection Errors",id:"connection-errors",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"globalartnestjs-temporal",children:"@globalart/nestjs-temporal"})}),"\n",(0,o.jsx)(n.p,{children:"A NestJS module for working with Temporal workflows and activities. Provides a convenient API for creating Temporal workers, registering activities, and using Temporal clients to start workflows."}),"\n",(0,o.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",metastring:"npm2yarn",children:"npm install @globalart/nestjs-temporal @temporalio/client @temporalio/worker @temporalio/workflow @temporalio/activity\n"})}),"\n",(0,o.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"@globalart/nestjs-temporal"})," package simplifies working with Temporal in NestJS applications by providing:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Easy worker registration"})," - Configure Temporal workers through decorators"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Activity discovery"})," - Automatic discovery and registration of activities"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Workflow client"})," - Simplified API for starting and managing workflows"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Type safety"})," - Full TypeScript support with proper types"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Global module"})," - Available throughout your application"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Activity decorators"})," - Use ",(0,o.jsx)(n.code,{children:"@Activities()"})," and ",(0,o.jsx)(n.code,{children:"@Activity()"})," to register activities"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Workflow decorators"})," - Use ",(0,o.jsx)(n.code,{children:"@Workflows()"})," and ",(0,o.jsx)(n.code,{children:"@WorkflowMethod()"})," to register workflows"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Client injection"})," - Inject Temporal clients using ",(0,o.jsx)(n.code,{children:"@InjectTemporalClient()"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Multiple workers"})," - Configure multiple workers with different queues"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Type safety"})," - Full TypeScript support"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,o.jsx)(n.h3,{id:"module-setup",children:"Module Setup"}),"\n",(0,o.jsxs)(n.p,{children:["Import ",(0,o.jsx)(n.code,{children:"TemporalModule"})," in your root module:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Module } from "@nestjs/common";\nimport { TemporalModule } from "@globalart/nestjs-temporal";\n\n@Module({\n  imports: [\n    TemporalModule.registerWorker({\n      taskQueue: "my-task-queue",\n      workflowsPath: require.resolve("./workflows"),\n      activities: {},\n    }),\n  ],\n})\nexport class AppModule {}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"registering-activities",children:"Registering Activities"}),"\n",(0,o.jsxs)(n.p,{children:["Use the ",(0,o.jsx)(n.code,{children:"@Activities()"})," and ",(0,o.jsx)(n.code,{children:"@Activity()"})," decorators to register activities:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Injectable } from "@nestjs/common";\nimport { Activities, Activity } from "@globalart/nestjs-temporal";\n\n@Injectable()\n@Activities()\nexport class OrderActivities {\n  @Activity()\n  async processOrder(orderId: string): Promise<void> {\n    console.log(`Processing order: ${orderId}`);\n  }\n\n  @Activity("send-notification")\n  async sendNotification(message: string): Promise<void> {\n    console.log(`Sending notification: ${message}`);\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"using-the-client",children:"Using the Client"}),"\n",(0,o.jsxs)(n.p,{children:["Use the ",(0,o.jsx)(n.code,{children:"@InjectTemporalClient()"})," decorator to inject the client:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Injectable } from "@nestjs/common";\nimport { InjectTemporalClient } from "@globalart/nestjs-temporal";\nimport { WorkflowClient } from "@temporalio/client";\n\n@Injectable()\nexport class OrderService {\n  constructor(\n    @InjectTemporalClient()\n    private readonly client: WorkflowClient\n  ) {}\n\n  async startOrderWorkflow(orderId: string) {\n    const handle = await this.client.start("processOrderWorkflow", {\n      args: [orderId],\n      taskQueue: "my-task-queue",\n      workflowId: `order-${orderId}`,\n    });\n    return handle;\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"registering-workflows",children:"Registering Workflows"}),"\n",(0,o.jsxs)(n.p,{children:["Use the ",(0,o.jsx)(n.code,{children:"@Workflows()"})," and ",(0,o.jsx)(n.code,{children:"@WorkflowMethod()"})," decorators to register workflows:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Workflows, WorkflowMethod } from "@globalart/nestjs-temporal";\nimport { proxyActivities } from "@temporalio/workflow";\n\n@Workflows()\nexport class OrderWorkflows {\n  @WorkflowMethod()\n  async processOrderWorkflow(orderId: string): Promise<void> {\n    const activities = proxyActivities<typeof OrderActivities>({\n      startToCloseTimeout: "1 minute",\n    });\n\n    await activities.processOrder(orderId);\n    await activities.sendNotification(`Order ${orderId} processed`);\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"temporalmoduleregisterworker",children:"TemporalModule.registerWorker"}),"\n",(0,o.jsx)(n.p,{children:"Registers a Temporal worker that will discover and execute activities."}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Option"}),(0,o.jsx)(n.th,{children:"Type"}),(0,o.jsx)(n.th,{children:"Required"}),(0,o.jsx)(n.th,{children:"Description"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"taskQueue"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"string"})}),(0,o.jsx)(n.td,{children:"Yes"}),(0,o.jsx)(n.td,{children:"Task queue name"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"workflowsPath"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"string"})}),(0,o.jsx)(n.td,{children:"Yes"}),(0,o.jsx)(n.td,{children:"Path to workflow files"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"activities"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"object"})}),(0,o.jsx)(n.td,{children:"Yes"}),(0,o.jsx)(n.td,{children:"Activities object (can be empty)"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"connection"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"ConnectionOptions"})}),(0,o.jsx)(n.td,{children:"No"}),(0,o.jsx)(n.td,{children:"Connection options for Temporal server"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"namespace"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"string"})}),(0,o.jsx)(n.td,{children:"No"}),(0,o.jsx)(n.td,{children:"Temporal namespace"})]})]})]}),"\n",(0,o.jsx)(n.h3,{id:"temporalmoduleregisterclient",children:"TemporalModule.registerClient"}),"\n",(0,o.jsx)(n.p,{children:"Registers a Temporal WorkflowClient for starting workflows."}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Option"}),(0,o.jsx)(n.th,{children:"Type"}),(0,o.jsx)(n.th,{children:"Required"}),(0,o.jsx)(n.th,{children:"Description"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"name"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"string"})}),(0,o.jsx)(n.td,{children:"No"}),(0,o.jsx)(n.td,{children:"Client name (for named clients)"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"connection"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"ConnectionOptions"})}),(0,o.jsx)(n.td,{children:"No"}),(0,o.jsx)(n.td,{children:"Connection options"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"workflowOptions"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"WorkflowClientOptions"})}),(0,o.jsx)(n.td,{children:"No"}),(0,o.jsx)(n.td,{children:"Workflow client options"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsx)(n.h3,{id:"creating-activities",children:"Creating Activities"}),"\n",(0,o.jsx)(n.p,{children:"Activities are the building blocks of Temporal workflows. They represent the actual work that needs to be done:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Injectable } from "@nestjs/common";\nimport { Activities, Activity } from "@globalart/nestjs-temporal";\n\n@Injectable()\n@Activities({ name: "payment-queue" })\nexport class PaymentActivities {\n  @Activity()\n  async chargeCreditCard(\n    cardNumber: string,\n    amount: number\n  ): Promise<{ transactionId: string }> {\n    return { transactionId: `txn-${Date.now()}` };\n  }\n\n  @Activity("refund-payment")\n  async refundPayment(transactionId: string): Promise<void> {\n    console.log(`Refunding transaction: ${transactionId}`);\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"creating-workflows",children:"Creating Workflows"}),"\n",(0,o.jsx)(n.p,{children:"Workflows orchestrate activities and define the business logic:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Workflows, WorkflowMethod } from "@globalart/nestjs-temporal";\nimport { proxyActivities } from "@temporalio/workflow";\n\ninterface PaymentActivities {\n  chargeCreditCard(\n    cardNumber: string,\n    amount: number\n  ): Promise<{ transactionId: string }>;\n  refundPayment(transactionId: string): Promise<void>;\n}\n\n@Workflows()\nexport class PaymentWorkflows {\n  @WorkflowMethod("process-payment")\n  async processPayment(\n    cardNumber: string,\n    amount: number\n  ): Promise<{ transactionId: string }> {\n    const activities = proxyActivities<PaymentActivities>({\n      startToCloseTimeout: "5 minutes",\n    });\n\n    try {\n      const result = await activities.chargeCreditCard(cardNumber, amount);\n      return result;\n    } catch (error) {\n      await activities.refundPayment(result.transactionId);\n      throw error;\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"using-multiple-workers",children:"Using Multiple Workers"}),"\n",(0,o.jsx)(n.p,{children:"You can configure multiple workers with different task queues:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Module } from "@nestjs/common";\nimport { TemporalModule } from "@globalart/nestjs-temporal";\n\n@Module({\n  imports: [\n    TemporalModule.registerWorker({\n      taskQueue: "order-queue",\n      workflowsPath: require.resolve("./workflows/order"),\n      activities: {},\n    }),\n    TemporalModule.registerWorker({\n      taskQueue: "payment-queue",\n      workflowsPath: require.resolve("./workflows/payment"),\n      activities: {},\n    }),\n  ],\n})\nexport class AppModule {}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"async-configuration",children:"Async Configuration"}),"\n",(0,o.jsxs)(n.p,{children:["Use ",(0,o.jsx)(n.code,{children:"registerWorkerAsync"})," when configuration depends on other async providers:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Module } from "@nestjs/common";\nimport { ConfigModule, ConfigService } from "@nestjs/config";\nimport { TemporalModule } from "@globalart/nestjs-temporal";\n\n@Module({\n  imports: [\n    ConfigModule.forRoot(),\n    TemporalModule.registerWorkerAsync({\n      imports: [ConfigModule],\n      useFactory: (configService: ConfigService) => ({\n        taskQueue: configService.get("TEMPORAL_TASK_QUEUE"),\n        workflowsPath: require.resolve("./workflows"),\n        activities: {},\n        connection: {\n          address: configService.get("TEMPORAL_ADDRESS"),\n        },\n      }),\n      inject: [ConfigService],\n    }),\n  ],\n})\nexport class AppModule {}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"using-named-clients",children:"Using Named Clients"}),"\n",(0,o.jsx)(n.p,{children:"You can register multiple clients with different names:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Module } from "@nestjs/common";\nimport { TemporalModule } from "@globalart/nestjs-temporal";\n\n@Module({\n  imports: [\n    TemporalModule.registerClient({\n      name: "primary",\n      connection: {\n        address: "localhost:7233",\n      },\n    }),\n    TemporalModule.registerClient({\n      name: "secondary",\n      connection: {\n        address: "localhost:7234",\n      },\n    }),\n  ],\n})\nexport class AppModule {}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Then inject the named client:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Injectable } from "@nestjs/common";\nimport { InjectTemporalClient } from "@globalart/nestjs-temporal";\nimport { WorkflowClient } from "@temporalio/client";\n\n@Injectable()\nexport class MyService {\n  constructor(\n    @InjectTemporalClient("primary")\n    private readonly primaryClient: WorkflowClient,\n    @InjectTemporalClient("secondary")\n    private readonly secondaryClient: WorkflowClient\n  ) {}\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,o.jsx)(n.h3,{id:"temporalmodule",children:"TemporalModule"}),"\n",(0,o.jsx)(n.h4,{id:"registerworkeroptions-workeroptions-dynamicmodule",children:(0,o.jsx)(n.code,{children:"registerWorker(options: WorkerOptions): DynamicModule"})}),"\n",(0,o.jsx)(n.p,{children:"Creates a global module with a configured Temporal worker."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"options"})," - Worker configuration options"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Returns:"})," ",(0,o.jsx)(n.code,{children:"DynamicModule"})," - Configured module"]}),"\n",(0,o.jsx)(n.h4,{id:"registerworkerasyncoptions-sharedworkerasyncconfiguration-dynamicmodule",children:(0,o.jsx)(n.code,{children:"registerWorkerAsync(options: SharedWorkerAsyncConfiguration): DynamicModule"})}),"\n",(0,o.jsx)(n.p,{children:"Creates a global module with a configured Temporal worker asynchronously."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"options"})," - Async worker configuration options"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Returns:"})," ",(0,o.jsx)(n.code,{children:"DynamicModule"})," - Configured module"]}),"\n",(0,o.jsx)(n.h4,{id:"registerclientoptions-temporalmoduleoptions-dynamicmodule",children:(0,o.jsx)(n.code,{children:"registerClient(options?: TemporalModuleOptions): DynamicModule"})}),"\n",(0,o.jsx)(n.p,{children:"Registers a Temporal WorkflowClient."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"options"})," - Optional client configuration options"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Returns:"})," ",(0,o.jsx)(n.code,{children:"DynamicModule"})," - Configured module"]}),"\n",(0,o.jsx)(n.h4,{id:"registerclientasyncoptions-sharedworkflowclientoptions-dynamicmodule",children:(0,o.jsx)(n.code,{children:"registerClientAsync(options: SharedWorkflowClientOptions): DynamicModule"})}),"\n",(0,o.jsx)(n.p,{children:"Registers a Temporal WorkflowClient asynchronously."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"options"})," - Async client configuration options"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"Returns:"})," ",(0,o.jsx)(n.code,{children:"DynamicModule"})," - Configured module"]}),"\n",(0,o.jsx)(n.h3,{id:"activities-decorator",children:"Activities Decorator"}),"\n",(0,o.jsx)(n.h4,{id:"activitiesqueuenameoroptions-string--activitiesoptions-classdecorator",children:(0,o.jsx)(n.code,{children:"@Activities(queueNameOrOptions?: string | ActivitiesOptions): ClassDecorator"})}),"\n",(0,o.jsx)(n.p,{children:"Marks a class as containing Temporal activities."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"queueNameOrOptions"})," - Optional queue name (string) or options object"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'@Injectable()\n@Activities("my-queue")\nexport class MyActivities {\n  @Activity()\n  async doSomething() {}\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"activity-decorator",children:"Activity Decorator"}),"\n",(0,o.jsx)(n.h4,{id:"activitynameoroptions-string--activityoptions-methoddecorator",children:(0,o.jsx)(n.code,{children:"@Activity(nameOrOptions?: string | ActivityOptions): MethodDecorator"})}),"\n",(0,o.jsx)(n.p,{children:"Marks a method as a Temporal activity."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"nameOrOptions"})," - Optional activity name (string) or options object"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'@Activity()\nasync processOrder(orderId: string) {}\n\n@Activity("custom-activity-name")\nasync anotherActivity() {}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"workflows-decorator",children:"Workflows Decorator"}),"\n",(0,o.jsx)(n.h4,{id:"workflowsnameoroptions-string--workflowsoptions-classdecorator",children:(0,o.jsx)(n.code,{children:"@Workflows(nameOrOptions?: string | WorkflowsOptions): ClassDecorator"})}),"\n",(0,o.jsx)(n.p,{children:"Marks a class as containing Temporal workflows."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"nameOrOptions"})," - Optional queue name (string) or options object"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'@Workflows("my-queue")\nexport class MyWorkflows {\n  @WorkflowMethod()\n  async myWorkflow() {}\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"workflowmethod-decorator",children:"WorkflowMethod Decorator"}),"\n",(0,o.jsx)(n.h4,{id:"workflowmethodnameoroptions-string--workflowmethodoptions-methoddecorator",children:(0,o.jsx)(n.code,{children:"@WorkflowMethod(nameOrOptions?: string | WorkflowMethodOptions): MethodDecorator"})}),"\n",(0,o.jsx)(n.p,{children:"Marks a method as a Temporal workflow method."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"nameOrOptions"})," - Optional workflow name (string) or options object"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'@WorkflowMethod()\nasync myWorkflow() {}\n\n@WorkflowMethod("custom-workflow-name")\nasync anotherWorkflow() {}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"injecttemporalclient",children:"InjectTemporalClient"}),"\n",(0,o.jsx)(n.h4,{id:"injecttemporalclientname-string-parameterdecorator",children:(0,o.jsx)(n.code,{children:"InjectTemporalClient(name?: string): ParameterDecorator"})}),"\n",(0,o.jsx)(n.p,{children:"Decorator for injecting a Temporal WorkflowClient."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"name"})," - Optional client name specified in the configuration"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'constructor(\n  @InjectTemporalClient()\n  private readonly client: WorkflowClient\n) {}\n\nconstructor(\n  @InjectTemporalClient("primary")\n  private readonly client: WorkflowClient\n) {}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,o.jsx)(n.h3,{id:"automatic-activity-discovery",children:"Automatic Activity Discovery"}),"\n",(0,o.jsxs)(n.p,{children:["The module automatically discovers all classes decorated with ",(0,o.jsx)(n.code,{children:"@Activities()"})," and registers their methods decorated with ",(0,o.jsx)(n.code,{children:"@Activity()"})," as Temporal activities."]}),"\n",(0,o.jsx)(n.h3,{id:"global-module",children:"Global Module"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"TemporalModule"})," is registered as a global module, meaning all configured workers and clients are available in all application modules without needing to import ",(0,o.jsx)(n.code,{children:"TemporalModule"})," in each module."]}),"\n",(0,o.jsx)(n.h3,{id:"application-shutdown",children:"Application Shutdown"}),"\n",(0,o.jsx)(n.p,{children:"The module automatically handles cleanup of Temporal client connections when the application shuts down."}),"\n",(0,o.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,o.jsx)(n.h3,{id:"complete-example",children:"Complete Example"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Module } from "@nestjs/common";\nimport {\n  TemporalModule,\n  Activities,\n  Activity,\n  InjectTemporalClient,\n} from "@globalart/nestjs-temporal";\nimport { WorkflowClient } from "@temporalio/client";\n\n@Injectable()\n@Activities()\nexport class EmailActivities {\n  @Activity()\n  async sendEmail(to: string, subject: string, body: string): Promise<void> {\n    console.log(`Sending email to ${to}: ${subject}`);\n  }\n}\n\n@Injectable()\nexport class EmailService {\n  constructor(\n    @InjectTemporalClient()\n    private readonly client: WorkflowClient\n  ) {}\n\n  async startEmailWorkflow(to: string, subject: string, body: string) {\n    const handle = await this.client.start("sendEmailWorkflow", {\n      args: [to, subject, body],\n      taskQueue: "email-queue",\n      workflowId: `email-${Date.now()}`,\n    });\n    return handle;\n  }\n}\n\n@Module({\n  imports: [\n    TemporalModule.registerWorker({\n      taskQueue: "email-queue",\n      workflowsPath: require.resolve("./workflows"),\n      activities: {},\n    }),\n    TemporalModule.registerClient(),\n  ],\n  providers: [EmailActivities, EmailService],\n})\nexport class EmailModule {}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Injectable } from "@nestjs/common";\nimport { InjectTemporalClient } from "@globalart/nestjs-temporal";\nimport { WorkflowClient } from "@temporalio/client";\n\n@Injectable()\nexport class OrderService {\n  constructor(\n    @InjectTemporalClient()\n    private readonly client: WorkflowClient\n  ) {}\n\n  async startOrderWorkflow(orderId: string) {\n    try {\n      const handle = await this.client.start("processOrderWorkflow", {\n        args: [orderId],\n        taskQueue: "order-queue",\n        workflowId: `order-${orderId}`,\n      });\n      return handle;\n    } catch (error) {\n      if (error instanceof Error) {\n        throw new Error(`Failed to start workflow: ${error.message}`);\n      }\n      throw error;\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"using-with-configservice",children:"Using with ConfigService"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { Module } from "@nestjs/common";\nimport { ConfigModule, ConfigService } from "@nestjs/config";\nimport { TemporalModule } from "@globalart/nestjs-temporal";\n\n@Module({\n  imports: [\n    ConfigModule.forRoot(),\n    TemporalModule.registerWorkerAsync({\n      imports: [ConfigModule],\n      useFactory: (configService: ConfigService) => ({\n        taskQueue:\n          configService.get<string>("TEMPORAL_TASK_QUEUE") || "default",\n        workflowsPath: require.resolve("./workflows"),\n        activities: {},\n        connection: {\n          address:\n            configService.get<string>("TEMPORAL_ADDRESS") || "localhost:7233",\n        },\n        namespace: configService.get<string>("TEMPORAL_NAMESPACE") || "default",\n      }),\n      inject: [ConfigService],\n    }),\n    TemporalModule.registerClientAsync({\n      imports: [ConfigModule],\n      useFactory: (configService: ConfigService) => ({\n        connection: {\n          address:\n            configService.get<string>("TEMPORAL_ADDRESS") || "localhost:7233",\n        },\n      }),\n      inject: [ConfigService],\n    }),\n  ],\n})\nexport class AppModule {}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Use decorators"})," - Always use ",(0,o.jsx)(n.code,{children:"@Activities()"})," and ",(0,o.jsx)(n.code,{children:"@Activity()"})," for activities"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Use decorators for workflows"})," - Use ",(0,o.jsx)(n.code,{children:"@Workflows()"})," and ",(0,o.jsx)(n.code,{children:"@WorkflowMethod()"})," for workflows"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Handle errors"})," - Always handle errors from workflow and activity executions"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Use type safety"})," - Define interfaces for your activities and workflows"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Organize workflows"})," - Store workflow files in a separate directory"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Use named clients"})," - Use named clients when working with multiple Temporal clusters"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Configure timeouts"})," - Always configure appropriate timeouts for activities and workflows"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,o.jsx)(n.h3,{id:"worker-not-starting",children:"Worker Not Starting"}),"\n",(0,o.jsx)(n.p,{children:"If the worker is not starting, make sure:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.code,{children:"taskQueue"})," is specified correctly"]}),"\n",(0,o.jsxs)(n.li,{children:["The ",(0,o.jsx)(n.code,{children:"workflowsPath"})," points to a valid directory"]}),"\n",(0,o.jsx)(n.li,{children:"The Temporal server is running and accessible"}),"\n",(0,o.jsx)(n.li,{children:"The connection options are correct"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"activities-not-found",children:"Activities Not Found"}),"\n",(0,o.jsx)(n.p,{children:"If activities are not being discovered:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Make sure the class is decorated with ",(0,o.jsx)(n.code,{children:"@Activities()"})]}),"\n",(0,o.jsxs)(n.li,{children:["Make sure methods are decorated with ",(0,o.jsx)(n.code,{children:"@Activity()"})]}),"\n",(0,o.jsx)(n.li,{children:"Ensure the class is registered as a provider in a module"}),"\n",(0,o.jsxs)(n.li,{children:["Check that ",(0,o.jsx)(n.code,{children:"DiscoveryModule"})," is imported (automatically imported by ",(0,o.jsx)(n.code,{children:"TemporalModule"}),")"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"client-not-found",children:"Client Not Found"}),"\n",(0,o.jsx)(n.p,{children:'If you get a "Temporal client not found" error:'}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Make sure ",(0,o.jsx)(n.code,{children:"TemporalModule.registerClient()"})," is called in your root module"]}),"\n",(0,o.jsxs)(n.li,{children:["The client name in ",(0,o.jsx)(n.code,{children:"@InjectTemporalClient()"})," matches the name in the configuration (if using named clients)"]}),"\n",(0,o.jsx)(n.li,{children:"The client is used after module initialization"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"connection-errors",children:"Connection Errors"}),"\n",(0,o.jsx)(n.p,{children:"If you experience connection issues:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Check that the Temporal server is running and accessible"}),"\n",(0,o.jsx)(n.li,{children:"Ensure the connection address is specified correctly"}),"\n",(0,o.jsx)(n.li,{children:"Check network settings and firewalls"}),"\n",(0,o.jsx)(n.li,{children:"Verify the namespace is correct (if using a custom namespace)"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);